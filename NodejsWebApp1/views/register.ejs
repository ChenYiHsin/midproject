<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>註冊頁面</title>
    <link href="./../bootstrap/css/bootstrap.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row mt-5">
            <div class="col-3"></div>
            <div class="col-6">
                <form>
                    <div class="form-group" style="text-align: center">
                        <h2 style="letter-spacing: 30px;">注册</h2>
                    </div>
                    <div class="form-group">
                        <label for="username">用户名</label>
                        <input type="text" class="form-control" id="username" placeholder="请输入用户名">
                        <small id="nousername" class="form-text text-muted float-right">
                            <span style="color: #bd2130;">您输入的用户名不符合规范！</span>
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="pwd">密碼</label>
                        <input type="password" class="form-control" id="pwd" placeholder="請输入密碼">
                        <small id="nopwd" class="form-text text-muted float-right">
                            <span style="color: #bd2130;">您輸入的用户名不符合規定！</span>
                        </small>
                    </div>
                    <div class="form-group mb-5">
                        <small id="register" class="form-text text-muted float-right">
                            <a href="./../index.html">登錄</a>
                        </small>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-primary  btn-block" id="btn1">確認</button>
                    </div>

                </form>
            </div>
            <div class="col-3"></div>
        </div>
    </div>

    <script src="./../common/jquery-3.3.1.js"></script>
    <script>$(function(){
        $("#nousername").hide();
        $("#nopwd").hide();
    })
    function register(){
        let username,pwd;
        username=$("#username").val();
        pwd=$("#pwd").val();

        if(/^\w{4,10}$/.test(username)){
        }else{
            $("nousername").css("display","block");
            $("#nousername").show();

        }
        if(/^\w{4,10}$/.test(pwd)){
        }else{
            $("#nopwd").show();
            $("#block").css("margin-top","25px");
            return;
        }
        let xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsfot.XMLHTTP");
        let data="";

        xhr.onreadystatechange=function(){
            data=JSON.parse(xhr.response);
            if(xhr.readyState==4){
                if(data.status==200){
                    alert("注册成功");
                    location.href="./../index.html";
                }else{
                    alert("注册失败");
                }
            }
        }
        xhr.open("post",'/register');
        xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");
        xhr.send(`username=${username}&pwd=${pwd}`);

    }
        $("#btn1")[0].addEventListener("click", register, true);
    </script>
    

</body>
</html>